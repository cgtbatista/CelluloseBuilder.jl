function _cellulose_topfile(; filename=nothing)

    if isnothing(filename)
        filename = tempname() * ".rtf"
    end

    topology_file = Base.open(filename, "w")
    
    Base.write(topology_file, "! This file is the topology file needed to build cellulose crystal (CHARMM36)")
    Base.write(topology_file, "\n")
    Base.write(topology_file, "! C6H12O6 pyranose monosaccharide atom types")
    Base.write(topology_file, "!! carbon")
    Base.write(topology_file, "MASS  -1  CC3161    12.01100 C ! C2, C3, C4 CH bound to OH")
    Base.write(topology_file, "MASS  -1  CC3162    12.01100 C ! C1 (anomeric) CH bound to OH")
    Base.write(topology_file, "MASS  -1  CC3163    12.01100 C ! C5 CH bound to exocylic CH2OH")
    Base.write(topology_file, "MASS  -1  CC321     12.01100 C ! generic acyclic CH2 carbon (hexopyranose C6)")
    Base.write(topology_file, "!! hydrogen")
    Base.write(topology_file, "MASS  -1  HCA1       1.00800 H ! aliphatic proton, CH")
    Base.write(topology_file, "MASS  -1  HCA2       1.00800 H ! aliphatic proton, CH2")
    Base.write(topology_file, "MASS  -1  HCP1       1.00800 H ! polar H")
    Base.write(topology_file, "!! oxygen")
    Base.write(topology_file, "MASS  -1  OC311     15.99940 O ! hydroxyl oxygen")
    Base.write(topology_file, "MASS  -1  OC3C61    15.99940 O ! ether in six membered ring")
    Base.write(topology_file, "MASS  -1  OC301     15.99940 O ! generic linear ether")
    Base.write(topology_file, "\n")
    Base.write(topology_file, "AUTOGENERATE angles dihedrals patch")
    Base.write(topology_file, "! DEFAults for patching FIRSt and LAST residues")
    Base.write(topology_file, "DEFA FIRS NONE LAST NONE")
    Base.write(topology_file, "\n")
    Base.write(topology_file, "!! RESIDS !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!")
    Base.write(topology_file, "\n")
    Base.write(topology_file, "RESI BGLC           0.000  ! 4C1 beta-D-glucose")
    Base.write(topology_file, "\n")
    Base.write(topology_file, "GROU                       !")
    Base.write(topology_file, "ATOM C1   CC3162    0.340  !")
    Base.write(topology_file, "ATOM H1   HCA1      0.090  !")
    Base.write(topology_file, "ATOM O1   OC311    -0.650  !")
    Base.write(topology_file, "ATOM HO1  HCP1      0.420  !")
    Base.write(topology_file, "ATOM C5   CC3163    0.110  !")
    Base.write(topology_file, "ATOM H5   HCA1      0.090  !")
    Base.write(topology_file, "ATOM O5   OC3C61   -0.400  !")
    Base.write(topology_file, "GROU                       !")
    Base.write(topology_file, "ATOM C2   CC3161    0.140  !")
    Base.write(topology_file, "ATOM H2   HCA1      0.090  !")
    Base.write(topology_file, "ATOM O2   OC311    -0.650  !")
    Base.write(topology_file, "ATOM HO2  HCP1      0.420  !")
    Base.write(topology_file, "GROU                       !")
    Base.write(topology_file, "ATOM C3   CC3161    0.140  !")
    Base.write(topology_file, "ATOM H3   HCA1      0.090  !")
    Base.write(topology_file, "ATOM O3   OC311    -0.650  !")
    Base.write(topology_file, "ATOM HO3  HCP1      0.420  !")
    Base.write(topology_file, "GROU")
    Base.write(topology_file, "ATOM C4   CC3161    0.140  !")
    Base.write(topology_file, "ATOM H4   HCA1      0.090  !")
    Base.write(topology_file, "ATOM O4   OC311    -0.650  !")
    Base.write(topology_file, "ATOM HO4  HCP1      0.420  !")
    Base.write(topology_file, "GROU")
    Base.write(topology_file, "ATOM C6   CC321     0.050  !")
    Base.write(topology_file, "ATOM H61  HCA2      0.090  !")
    Base.write(topology_file, "ATOM H62  HCA2      0.090  !")
    Base.write(topology_file, "ATOM O6   OC311    -0.650  !")
    Base.write(topology_file, "ATOM HO6  HCP1      0.420  !")
    Base.write(topology_file, "\n")
    Base.write(topology_file, "BOND C1   O1        C1   H1        O1   HO1       C1   O5        C1   C2")
    Base.write(topology_file, "BOND C2   H2        C2   O2        O2   HO2       C2   C3        C3   H3")
    Base.write(topology_file, "BOND C3   O3        O3   HO3       C3   C4        C4   H4        C4   O4")
    Base.write(topology_file, "BOND O4   HO4       C4   C5        C5   H5        C5   C6        C6   H61")
    Base.write(topology_file, "BOND C6   H62       C6   O6        O6   HO6       C5   O5")
    Base.write(topology_file, "!    I    J    K    L      R(IK)   T(IKJ)    PHI   T(JKL)   R(KL)")
    Base.write(topology_file, "IC   O1   C2  *C1   H1     1.3899  110.90  120.10  104.58   1.0836")
    Base.write(topology_file, "IC   O1   O5  *C1   C2     1.3899  108.62  122.10  110.88   1.5316")
    Base.write(topology_file, "IC   O2   C3  *C2   H2     1.4594  108.12 -118.78  111.06   1.1375")
    Base.write(topology_file, "IC   O2   C1  *C2   C3     1.4594  115.65 -125.60  113.28   1.4983")
    Base.write(topology_file, "IC   O3   C4  *C3   H3     1.4071  113.48  122.06  103.39   1.0895")
    Base.write(topology_file, "IC   O3   C2  *C3   C4     1.4071  108.48  124.18  109.26   1.5497")
    Base.write(topology_file, "IC   O4   C5  *C4   H4     1.3940  111.12 -110.35  108.66   1.0857")
    Base.write(topology_file, "IC   O4   C3  *C4   C5     1.3940  112.77 -129.39  115.62   1.5530")
    Base.write(topology_file, "IC   C6   O5  *C5   H5     1.5597  111.17  120.85  110.98   1.1092")
    Base.write(topology_file, "IC   C6   C4  *C5   O5     1.5597  109.90  122.92  110.30   1.4512")
    Base.write(topology_file, "IC   O6   H62 *C6   H61    1.4589  116.11 -112.93  103.57   1.1467")
    Base.write(topology_file, "IC   O6   C5  *C6   H62    1.4589  109.41 -135.95  118.22   1.0853")
    Base.write(topology_file, "IC   O5   C1   C2   C3     1.4620  110.88   57.82  113.28   1.4983")
    Base.write(topology_file, "IC   C1   C2   C3   C4     1.5316  113.28  -48.40  109.26   1.5497")
    Base.write(topology_file, "IC   C2   C3   C4   C5     1.4983  109.26   45.07  115.62   1.5530")
    Base.write(topology_file, "IC   C3   C4   C5   O5     1.5497  115.62  -49.19  110.30   1.4512")
    Base.write(topology_file, "IC   C4   C5   O5   C1     1.5530  110.30   56.36  112.12   1.4620")
    Base.write(topology_file, "IC   C5   O5   C1   C2     1.4512  112.12  -61.39  110.88   1.5316")
    Base.write(topology_file, "IC   C4   C5   C6   O6     1.5530  109.90 -177.46  109.41   1.4589")
    Base.write(topology_file, "IC   O5   C1   O1   HO1    1.4620  108.62   72.25  106.48   0.9328")
    Base.write(topology_file, "IC   C1   C2   O2   HO2    1.5316  115.65  135.41  116.81   0.9527")
    Base.write(topology_file, "IC   C2   C3   O3   HO3    1.4983  108.48  -71.46  120.86   0.9441")
    Base.write(topology_file, "IC   C3   C4   O4   HO4    1.5497  112.77   47.45  109.31   0.9911")
    Base.write(topology_file, "IC   C5   C6   O6   HO6    1.5597  109.41  -54.60  118.82   0.95210")
    Base.write(topology_file, "PATC  FIRS NONE LAST NONE")
    Base.write(topology_file, "\n")
    Base.write(topology_file, "!! PATCHES !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!")
    Base.write(topology_file, "\n")
    Base.write(topology_file, "! equatorial-equatorial 1->4 linkage")
    Base.write(topology_file, "! LACTOS03, EYOCUQ01, CELLOB01")
    Base.write(topology_file, "PRES 14bb           0.02 ! (i)1->4(i-1) equatorial at C1 and equatorial at C4")
    Base.write(topology_file, "dele atom 1HO4")
    Base.write(topology_file, "dele atom 2HO1")
    Base.write(topology_file, "dele atom 2O1")
    Base.write(topology_file, "ATOM 1C4  CC3161    0.09 !")
    Base.write(topology_file, "ATOM 1O4  OC301    -0.36 !")
    Base.write(topology_file, "ATOM 2C1  CC3162    0.29 !")
    Base.write(topology_file, "BOND 1O4  2C1")
    Base.write(topology_file, "!    I    J    K    L      R(IK)   T(IKJ)    PHI   T(JKL)   R(KL)")
    Base.write(topology_file, "IC   1C3  1C4  1O4  2C1    1.5009  110.76   81.86  121.00   1.3902  ! psi")
    Base.write(topology_file, "IC   1C4  1O4  2C1  2O5    1.4560  121.00 -130.97  108.63   1.4470  ! phi")
    Base.write(topology_file, "IC   1O4  2O5 *2C1  2C2    1.3896  108.63  122.12  110.87   1.5318")
    Base.write(topology_file, "IC   2O5  1O4 *2C1  2H1    1.4470  108.63  121.92  111.32   1.0837")
    Base.write(topology_file, "\n")
    Base.write(topology_file, "END")

    Base.close(topology_file)

    return filename
end